import{initCustomDataTable}from"../DataTable/datatables-init.js";import{DataTableListener,GeneralEventListener}from"../utils/listeners.js";let table_escuelas;function registrarAlumno(){Swal.fire({title:"Agregar alumno",html:'\n    <div class="container">\n      <div class="row mb-3">\n            <div class="col-12">\n                <label for="nombre">Nombre</label>\n                <input class="form-control" id="nombre" type="text" placeholder="Nombre...">\n            </div>\n      </div>\n      <div class="row mb-3">\n            <div class="col-6">\n                <label for="apellido_paterno">Apellido Materno</label>\n                <input id="apellido_paterno"class="form-control" type="text" placeholder="Apellido paterno..">\n            </div>\n            <div class="col-6">\n              <label for="apellido_materno">Apellido materno</label>\n              <input id="apellido_materno" class="form-control" type="text" placeholder="Apellido materno...">\n          </div>\n    </div>\n    <div class="row mb-3">\n        <div class="col-6">\n            <label for="cumple">Cumpleaños</label>\n            <input id="cumple" class="form-control" type="date">\n        </div>\n        <div class="col-6">\n          <label for="genero">Genero</label>\n          <select id="genero" class="form-control">\n              <option value="M">Masculino</option>\n              <option value="F">Femenino</option>\n          </select>\n        </div>\n    </div>\n    <div class="row">\n    <div class="col-6">\n        <label for="telefono">Teléfono</label>\n        <input id="telefono" class="form-control" type="text" placeholder="+52 8681...">\n    </div>\n    \x3c!----<div class="col-6">\n        <label for="grupo">Grupo</label>\n        <select id="grupo" class="form-control selectpicker" placeholder="Selecciona un grupo">\n        </select>\n    </div>--\x3e\n   \n</div>\n    </div>\n    ',didOpen:()=>{},confirmButtonText:"Registrar",showCloseButton:!0,preConfirm:e=>{let l=$("#nombre").val(),a=$("#apellido_paterno").val();$("#apellido_materno").val(),$("#grupo").val();l?a||Swal.showValidationMessage("Escribe un apellido paterno"):Swal.showValidationMessage("Escribe un nombre")}}).then((e=>{if(e.isConfirmed){let e=$("#nombre").val(),l=$("#apellido_paterno").val(),a=$("#apellido_materno").val(),n=$("#cumple").val(),o=$("#genero").val(),t=$("#telefono").val();$.ajax({type:"POST",url:BASE_URL+"api/alumnos.php?tipo=registrar",data:{nombre:e,apellido_paterno:l,apellido_materno:a,cumple:n,genero:o,telefono:t},dataType:"JSON",success:function(e){table_escuela.ajax.reload(null,!1),1==e.estatus?Swal.fire({icon:"success",html:`\n                    ${e.mensaje}<br>\n                    `,allowOutsideClick:!0,confirmButtonText:"Entendido",showCancelButton:!1}).then((e=>{e.isConfirmed&&table_escuelas.ajax.reload(!1)})):Swal.fire({icon:"error",html:`\n                    Ocurrio un error: ${e.mensaje}\n                    `,allowOutsideClick:!0,showCancelButton:!1,confirmButtonText:"Entendido"}).then((e=>{e.isConfirmed&&table_escuelas.ajax.reload(!1)}))}})}}))}function cancelarAlumno(e){Swal.fire({icon:"question",title:"¿Deseas desactivar este alumno?",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Si",showCloseButton:!0}).then((l=>{l.isConfirmed&&$.ajax({type:"POST",url:BASE_URL+"servidor/historial/eliminar-registro.php",data:{id_reg:e,tabla:"alumnos"},dataType:"JSON",success:function(e){table_escuelas.ajax.reload(null,!1),1==e.estatus?Swal.fire({icon:"success",html:`\n                    ${e.mensaje}<br>\n                    `,allowOutsideClick:!0,confirmButtonText:"Entendido",showCancelButton:!1}).then((e=>{e.isConfirmed&&tabla.ajax.reload(!1)})):Swal.fire({icon:"error",html:`\n                    Ocurrio un error: ${e.mensaje}\n                    `,allowOutsideClick:!0,showCancelButton:!1,confirmButtonText:"Entendido"}).then((e=>{e.isConfirmed&&tabla.ajax.reload(!1)}))}})}))}function editarAlumno(e){Swal.fire({title:"Editar alumno",html:'\n    <div class="container">\n      <div class="row mb-3">\n            <div class="col-12">\n                <label for="nombre">Nombre</label>\n                <input class="form-control" id="nombre" type="text" placeholder="Nombre...">\n            </div>\n      </div>\n      <div class="row mb-3">\n            <div class="col-6">\n                <label for="apellido_paterno">Apellido Materno</label>\n                <input id="apellido_paterno"class="form-control" type="text" placeholder="Apellido paterno..">\n            </div>\n            <div class="col-6">\n              <label for="apellido_materno">Apellido materno</label>\n              <input id="apellido_materno" class="form-control" type="text" placeholder="Apellido materno...">\n          </div>\n    </div>\n    <div class="row mb-3">\n        <div class="col-6">\n            <label for="cumple">Cumpleaños</label>\n            <input id="cumple" class="form-control" type="date">\n        </div>\n        <div class="col-6">\n          <label for="genero">Genero</label>\n          <select id="genero" class="form-control">\n              <option value="M">Masculino</option>\n              <option value="F">Femenino</option>\n          </select>\n        </div>\n    </div>\n    <div class="row">\n    <div class="col-6">\n        <label for="telefono">Teléfono</label>\n        <input id="telefono" class="form-control" type="text" placeholder="+52 8681...">\n    </div>\n    \x3c!----<div class="col-6">\n        <label for="grupo">Grupo</label>\n        <select id="grupo" class="form-control selectpicker" placeholder="Selecciona un grupo">\n        </select>\n    </div>--\x3e\n   \n</div>\n    </div>\n    ',didOpen:()=>{$.ajax({type:"post",url:BASE_URL+"api/alumnos.php?tipo=traer",data:{id_alumno:e},dataType:"json",success:function(e){e.estatus?e.data.forEach((e=>{$("#nombre").val(e.nombre),$("#apellido_paterno").val(e.apellido_paterno),$("#apellido_materno").val(e.apellido_materno),$("#cumple").val(e.fecha_cumple),$("#genero").val(e.genero),$("#telefono").val(e.telefono)})):alert("No se encontró el alumno")}})},confirmButtonText:"Actualizar",showCloseButton:!0,preConfirm:e=>{let l=$("#nombre").val(),a=$("#apellido_paterno").val();l?a||Swal.showValidationMessage("Escribe un apellido paterno"):Swal.showValidationMessage("Escribe un nombre")}}).then((l=>{if(l.isConfirmed){let l=$("#nombre").val(),a=$("#apellido_paterno").val(),n=$("#apellido_materno").val(),o=$("#cumple").val(),t=$("#genero").val(),i=$("#telefono").val();$.ajax({type:"POST",url:BASE_URL+"api/alumnos.php?tipo=actualizar",data:{id_alumno:e,nombre:l,apellido_paterno:a,apellido_materno:n,cumple:o,genero:t,telefono:i},dataType:"JSON",success:function(e){table_escuelas.ajax.reload(null,!1),1==e.estatus?Swal.fire({icon:"success",html:`\n                    ${e.mensaje}<br>\n                    `,allowOutsideClick:!0,confirmButtonText:"Entendido",showCancelButton:!1}).then((e=>{e.isConfirmed&&tabla.ajax.reload(!1)})):Swal.fire({icon:"error",html:`\n                    Ocurrio un error: ${e.mensaje}\n                    `,allowOutsideClick:!0,showCancelButton:!1,confirmButtonText:"Entendido"}).then((e=>{e.isConfirmed&&tabla.ajax.reload(!1)}))}})}}))}$(document).ready((function(){$("#role").attr("role");table_escuelas=initCustomDataTable("#tabla-escuelas",BASE_URL+"api/escuelas.php?tipo=datatable",[{data:"id",title:"#"},{data:"nombre",title:"Nombre"},{data:"direccion",title:"Dirección"},{data:"cedula",title:"Cedula"},{data:"telefono",title:"Teléfono"},{data:"fecha_registro",title:"Fecha reg."},{data:"fecha_pago",title:"Prox. pago"},{data:null,title:"Estatus",render:e=>{let l="";return l=1==e.estatus?'<span class="badge bg-success">Activo</span>':'<span class="badge bg-secondary">Inactivo</span>',l}},{data:null,title:"Opciones",render:function(e,l,a){return'\n            <div class=\'row\'>\n              <div class=\'col-12 col-md-12\'>\n                <div class="btn btn-primary btn-editar-alumno">\n                  <i class="fa-solid fa-pen-to-square"></i>\n                </div>\n                <div class="btn btn-danger btn-cancelar-alumno">\n                  <i class="fa-solid fa-trash"></i>\n                </div>\n              </div>\n            </div>'}}]),DataTableListener(table_escuelas,"click",".btn-editar-alumno",editarAlumno),DataTableListener(table_escuelas,"click",".btn-cancelar-alumno",cancelarAlumno),GeneralEventListener("btn-registrar-alumno","click",registrarAlumno)}));