function verDocumentos(e){console.log(e),$.ajax({type:"post",url:"./../servidor/documentos/traer-registro.php",data:{id_documento:e},dataType:"json",success:function(a){a.estatus&&Swal.fire({width:"900px",html:`\n            <h3 class="mb-3"><b>Documentos cargados</b><h3>\n              <div class="row mb-3">\n                  <div class="col-md-12 col-12">\n                      <h3 class><b>${a.datos.titulo}</b></h3>\n                      <span>${a.datos.descripcion}</span>\n                  </div>\n              </div>\n              <div class="row">\n                  <div class="col-md-12 col-12">\n                    <ul class="list-group">\n                      <li class="list-group-item list-group-item-action">\n                          <div class="row">\n                              <div class="col-md-1 col-12">\n                                  #\n                              </div>\n                              <div class="col-md-6 col-12">\n                                  Nombre\n                              </div>\n                              <div class="col-md-3 col-12">\n                                  Preview\n                              </div>\n                              <div class="col-md-2 col-12">\n                              Descargar\n                          </div>\n                          </div>\n                      </li>\n                      <div id="lista-documentos"></div>\n                    </ul>\n                  </div>\n              </div>\n            `,didOpen:function(){let o=$("#lista-documentos");if(a.estatus){let t=0;a.datos.archivos.forEach((a=>{t++,o.append(`\n                  <li class="list-group-item list-group-item-action">\n                      <div class="row">\n                          <div class="col-md-1 col-12">\n                              ${t}\n                          </div>\n                          <div class="col-md-6 col-12">\n                              ${a.nombre_documento}\n                          </div>\n                          <div class="col-md-3 col-12">\n                           <div id="area-canvas_${t}"></div>\n                          </div>\n                          <div class="col-md-2 col-12">\n                               <div id="descargar" onclick="descargarArchivo('./docs/${e}/${a.ruta}', '${a.nombre_documento}')" class="btn btn-success"><i class="fa-solid fa-download"></i></div>\n                               <div class="btn btn-danger" onclick="eliminarRegistro(${a.id},2,'Documento')"><i class="fa-solid fa-trash"></i></div>                 \n                          </div>\n                      </div>\n                  </li>\n                  `),cargarDocumentoMiniatura(`area-canvas_${t}`,e,a.ruta,a.id,a.extension)}))}else o.append('\n                <li class="list-group-item list-group-item-action">\n                <div class="row">\n                    <div class="col-md-12 text-center col-12">\n                      Hubo un error y no se cargaron los documentos\n                    </div>\n                    </div>\n                </li>\n                ')}})}})}function cargarDocumentoMiniatura(e,a,o,t,n){let i=$(`#${e}`);$.ajax({url:"./docs/"+a+"/"+o,method:"GET",xhr:function(){var e=new window.XMLHttpRequest;return e.responseType="arraybuffer",e},success:function(r){if("pdf"==n){var s=new Uint8Array(r),l=URL.createObjectURL(new Blob([s],{type:"application/pdf"})),d=window["pdfjs-dist/build/pdf"];console.log(i),i.empty().append(`\n          \n          <canvas id="thumbnailCanvas_${t}" style="width:70px !important;"></canvas>`);var c=document.getElementById("thumbnailCanvas_"+t);d.getDocument(l).promise.then((function(e){console.log(t),e.getPage(1).then((function(e){var a=e.getViewport({scale:.3}),o=c.getContext("2d");c.width=a.width,c.height=a.height;var t={canvasContext:o,viewport:a};e.render(t).promise.then((function(){}))}))}))}else if("jpg"===n||"png"===n||"jpeg"===n){let e=Math.floor(9e5*Math.random())+1e5;i.empty().append(`\n          <img style="width:70px !important;" src="./docs/${a}/${o}?v=${e}">`)}else{let e=Math.floor(9e5*Math.random())+1e5;i.empty().append(`\n      <img style="width:70px !important;" src="./img/documento.jpg?v=${e}">`)}$(`#${e}`).attr("documento",!0)},error:function(e){i.empty().append('\n        <div class="contenedor-cargar-documento" id="contenedor-cargar-documento">Sin factura cargada</div>\n        \n        '),$("#area-canvas").attr("documento",!1)}})}function descargarArchivo(e,a){fetch(e).then((e=>e.blob())).then((e=>{const o=window.URL.createObjectURL(e),t=document.createElement("a");t.href=o,t.download=a,document.body.appendChild(t),t.click(),document.body.removeChild(t)})).catch((e=>console.error("Error al descargar el archivo:",e)))}$(document).ready((function(){const e=$("#role").attr("role");tabla=$("#example").DataTable({processing:!0,serverSide:!0,ajax:{url:"../servidor/documentos/server_processing.php",dataType:"json"},responsive:!0,order:[0,"desc"],columns:[{data:0,title:"#"},{data:1,title:"Titulo"},{data:2,title:"Descripción"},{data:3,title:"Fecha"},{data:4,title:"Hora"},{data:5,title:"Mestro"},{data:null,title:"Opciones",render:function(a){return 1!=e||2!=e?`\n                <div class='row'>\n                    <div class='col-12 col-md-12'>\n                        <div class="btn btn-info" onclick="verDocumentos(${a[0]})">\n                            <i class="fa-solid fa-eye"></i>\n                        </div> \n                        <div class="btn btn-danger" onclick="eliminarRegistro(${a[0]}, 1, 'Registro')">\n                            <i class="fa-solid fa-trash"></i>\n                        </div>\n                    </div>\n                </div>\n                `:`\n                <div class='row'>\n                     <div class='col-12 col-md-12'>\n                      <div class="btn btn-info" onclick="verDocumentos(${a[0]})">\n                          <i class="fa-solid fa-eye"></i>\n                      </div>\n                   </div>\n                </div>\n                `}}],language:language_options})}));let language_options={processing:"Procesando...",lengthMenu:"Mostrar _MENU_ registros",zeroRecords:"No se encontraron resultados",emptyTable:"Ningún dato disponible en esta tabla",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)",search:"Buscar:",infoThousands:",",loadingRecords:"Cargando...",paginate:{first:"Primero",last:"Último",next:"Siguiente",previous:"Anterior"},aria:{sortAscending:": Activar para ordenar la columna de manera ascendente",sortDescending:": Activar para ordenar la columna de manera descendente"},buttons:{copy:"Copiar",colvis:"Visibilidad",collection:"Colección",colvisRestore:"Restaurar visibilidad",copyKeys:"Presione ctrl o u2318 + C para copiar los datos de la tabla al portapapeles del sistema. <br /> <br /> Para cancelar, haga clic en este mensaje o presione escape.",copySuccess:{1:"Copiada 1 fila al portapapeles",_:"Copiadas %ds fila al portapapeles"},copyTitle:"Copiar al portapapeles",csv:"CSV",excel:"Excel",pageLength:{"-1":"Mostrar todas las filas",_:"Mostrar %d filas"},pdf:"PDF",print:"Imprimir",renameState:"Cambiar nombre",updateState:"Actualizar",createState:"Crear Estado",removeAllStates:"Remover Estados",removeState:"Remover",savedStates:"Estados Guardados",stateRestore:"Estado %d"},autoFill:{cancel:"Cancelar",fill:"Rellene todas las celdas con <i>%d</i>",fillHorizontal:"Rellenar celdas horizontalmente",fillVertical:"Rellenar celdas verticalmentemente"},decimal:",",searchBuilder:{add:"Añadir condición",button:{0:"Constructor de búsqueda",_:"Constructor de búsqueda (%d)"},clearAll:"Borrar todo",condition:"Condición",conditions:{date:{after:"Despues",before:"Antes",between:"Entre",empty:"Vacío",equals:"Igual a",notBetween:"No entre",notEmpty:"No Vacio",not:"Diferente de"},number:{between:"Entre",empty:"Vacio",equals:"Igual a",gt:"Mayor a",gte:"Mayor o igual a",lt:"Menor que",lte:"Menor o igual que",notBetween:"No entre",notEmpty:"No vacío",not:"Diferente de"},string:{contains:"Contiene",empty:"Vacío",endsWith:"Termina en",equals:"Igual a",notEmpty:"No Vacio",startsWith:"Empieza con",not:"Diferente de",notContains:"No Contiene",notStarts:"No empieza con",notEnds:"No termina con"},array:{not:"Diferente de",equals:"Igual",empty:"Vacío",contains:"Contiene",notEmpty:"No Vacío",without:"Sin"}},data:"Data",deleteTitle:"Eliminar regla de filtrado",leftTitle:"Criterios anulados",logicAnd:"Y",logicOr:"O",rightTitle:"Criterios de sangría",title:{0:"Constructor de búsqueda",_:"Constructor de búsqueda (%d)"},value:"Valor"},searchPanes:{clearMessage:"Borrar todo",collapse:{0:"Paneles de búsqueda",_:"Paneles de búsqueda (%d)"},count:"{total}",countFiltered:"{shown} ({total})",emptyPanes:"Sin paneles de búsqueda",loadMessage:"Cargando paneles de búsqueda",title:"Filtros Activos - %d",showMessage:"Mostrar Todo",collapseMessage:"Colapsar Todo"},select:{cells:{1:"1 celda seleccionada",_:"%d celdas seleccionadas"},columns:{1:"1 columna seleccionada",_:"%d columnas seleccionadas"},rows:{1:"1 fila seleccionada",_:"%d filas seleccionadas"}},thousands:".",datetime:{previous:"Anterior",next:"Proximo",hours:"Horas",minutes:"Minutos",seconds:"Segundos",unknown:"-",amPm:["AM","PM"],months:{0:"Enero",1:"Febrero",2:"Marzo",3:"Abril",4:"Mayo",5:"Junio",6:"Julio",7:"Agosto",8:"Septiembre",9:"Octubre",10:"Noviembre",11:"Diciembre"},weekdays:["Dom","Lun","Mar","Mie","Jue","Vie","Sab"]},editor:{close:"Cerrar",create:{button:"Nuevo",title:"Crear Nuevo Registro",submit:"Crear"},edit:{button:"Editar",title:"Editar Registro",submit:"Actualizar"},remove:{button:"Eliminar",title:"Eliminar Registro",submit:"Eliminar",confirm:{1:"¿Está seguro que desea eliminar 1 fila?",_:"¿Está seguro que desea eliminar %d filas?"}},error:{system:'Ha ocurrido un error en el sistema (<a target="\\"rel="\\nofollow"href="\\">Más información&lt;\\/a&gt;).</a>'},multi:{title:"Múltiples Valores",info:"Los elementos seleccionados contienen diferentes valores para este registro. Para editar y establecer todos los elementos de este registro con el mismo valor, hacer click o tap aquí, de lo contrario conservarán sus valores individuales.",restore:"Deshacer Cambios",noMulti:"Este registro puede ser editado individualmente, pero no como parte de un grupo."}},info:"Mostrando _START_ a _END_ de _TOTAL_ registros",stateRestore:{creationModal:{button:"Crear",name:"Nombre:",order:"Clasificación",paging:"Paginación",search:"Busqueda",select:"Seleccionar",columns:{search:"Búsqueda de Columna",visible:"Visibilidad de Columna"},title:"Crear Nuevo Estado",toggleLabel:"Incluir:"},emptyError:"El nombre no puede estar vacio",removeConfirm:"¿Seguro que quiere eliminar este %s?",removeError:"Error al eliminar el registro",removeJoiner:"y",removeSubmit:"Eliminar",renameButton:"Cambiar Nombre",renameLabel:"Nuevo nombre para %s",duplicateError:"Ya existe un Estado con este nombre.",emptyStates:"No hay Estados guardados",removeTitle:"Remover Estado",renameTitle:"Cambiar Nombre Estado"}};