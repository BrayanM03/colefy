function reporteAbonosGlobal(a){const o=new jsPDF;let e=document.getElementById("fecha-descargar").value;fetch("../servidor/abonos/traer-abonos-cliente.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orden_id:a,fecha:e})}).then((a=>a.json())).then((a=>{if(6==a.proyecto_id?logo=data_logo_montealto.replace(/[\s"\\]/gm,""):10==a.proyecto_id?logo=data_logo_vallegracia.replace(/[\s"\\]/gm,""):9==a.proyecto_id?logo=data_logo_villaanaiz.replace(/[\s"\\]/gm,""):11==a.datos.id_proyecto?logo=data_logo_montealto_2.replace(/[\s"\\]/gm,""):12==a.datos.id_proyecto&&(logo=data_logo_magnolia_delsur.replace(/[\s"\\]/gm,"")),logo_cb=logo_letras_abajo.replace(/[\s"\\]/gm,""),logo_whats=logo_whatsapp.replace(/[\s"\\]/gm,""),logo_addr=logo_address.replace(/[\s"\\]/gm,""),o.addImage(logo_cb,"JPEG",10,0,30,25),o.addImage(logo,"JPEG",40,5,30,15),o.setFont("helvetica","normal"),o.setFontSize(10),o.text(e,173,23,"center"),o.addImage(logo_whats,"PNG",78,9,4,4),o.text("(868) 274 1147",95,12,"center"),o.addImage(logo_addr,"PNG",76.5,14,6,6),o.text("C. España 71, Buena Vista, 87497 \nHeroica Matamoros, Tamps.",110,18,"center"),o.setFont("helvetica","bold"),o.setFontSize(11),o.text("TICKET DE ABONO",162,12),o.setFontSize(9),o.text("Folio "+a.id+"-",170,16),cliente_mayus=a.cliente_etiqueta.toUpperCase(),o.text("Nombre del titular: ",10,35),o.text(cliente_mayus,40,35),DatosGenerales=[],total_neto=0,null!=a.abonos){penalizacion_sumatoria=0;for(let o in a.abonos){a.abonos[o].forEach((a=>{proyecto=a.proyecto,manzana=a.manzana,lote=a.lote,total=a.cantidad,tipo=a.tipo,mes=a.mes,year=a.year,no_abono=a.no_abono,penalizacion_monto=parseFloat(a.penalizacion_monto),penalizacion_sumatoria+=penalizacion_monto,total_neto+=parseFloat(total),total_form=parseFloat(total).toLocaleString("en"),total_="$"+total_form,obj_abono={manzana:manzana,lote:lote,tipo:tipo,no_abono:no_abono,mes:mes,year:year,total:total_,penalizacion:penalizacion_monto},DatosGenerales.push(obj_abono)}))}}else obj_abono={tipo:"Sin datos"},penalizacion_sumatoria=0,DatosGenerales.push(obj_abono);o.autoTable({headStyles:{fillColor:[211,211,211],textColor:[54,69,79],halign:"justify"},startY:44,body:DatosGenerales,styles:{cellPadding:4,fontSize:11},margin:{left:8,top:8},tableWidth:190,columns:[{header:"Manzana",dataKey:"manzana"},{header:"Lote",dataKey:"lote"},{header:"Tipo",dataKey:"tipo"},{header:"No. abono",dataKey:"no_abono"},{header:"Mes",dataKey:"mes"},{header:"Año",dataKey:"year"},{header:"Total",dataKey:"total"},{header:"Penalización",dataKey:"penalizacion"}],didDrawPage:a=>{alturaPartidas=a.cursor.y}}),o.setFontSize(11),penalizacion=penalizacion_sumatoria;const t=total_neto.toLocaleString("en"),n=penalizacion.toLocaleString("en");neto=parseFloat(total_neto)+parseFloat(penalizacion);const l=neto.toLocaleString("en");o.text("Total: $"+t,149,alturaPartidas+6),o.text("Penalizacion: $"+n,149,alturaPartidas+12),o.text("Neto: $"+l,149,alturaPartidas+18);var r="<embed width='100%' height='100%' src='"+o.output("datauristring")+"'/>",i=window.open();i.document.open(),i.document.write(r),i.document.close()}))}function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+a+"=([^&#]*)").exec(location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))}function cerrar(){window.open("","_parent",""),window.close()}