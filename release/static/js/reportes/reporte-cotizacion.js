function verRemision(e){const t=new jsPDF;pageHeight=t.internal.pageSize.height,$.ajax({type:"POST",url:"../servidor/reportes/traer-datos-de-orden.php",data:{id_orden:e,tabla:"cotizaciones",indicador:"id",tabla_detalle:"detalle_cotizacion",tipo:"cotizacion",indicador_detalle:"cotizacion_id"},dataType:"JSON",success:function(e){console.log(e),setHeader(t,e),setContentHeader(t,e),setContentBody(t,e);var o="<embed width='100%' height='100%' src='"+t.output("datauristring")+"' style='margin:0px; padding:0px;'/>",r=window.open();r.document.open(),r.document.write(o),r.document.close(),r.document.body.id="embed"}})}function setHeader(e,t){logo=data_logo.replace(/[\s"\\]/gm,""),e.addImage(logo,"JPEG",8,5,33,16),e.addFont("Monaco-bold.ttf","bold"),e.text("Sistemas y Servicios HC",80,10),e.setFontSize(11),e.setTextColor(0,0,0),e.text("CotizaciÃ³n",170,10),e.text("C"+t.folio,180,18),e.setDrawColor(0,170,228),e.roundedRect(169,12,28,9,3,3,"S"),e.setTextColor(107,107,107),e.addFont("Monaco-normal.ttf","normal");let o=t.datos_sucursal.direccion.split("Heroica Matamoros");e.text(o[0],75,16),e.text("Matamoros Tamaulipas",90,20),e.text("SSH180309TY1 8688179502",85,25)}function setContentHeader(e,t){e.setFontType("bold"),e.setFontSize(14),e.setTextColor(0,0,0),e.text(t.datos_cliente,10,50),e.setFontSize(12),e.setFontType("normal"),e.setTextColor(107,107,107),e.text(t.direccion,10,56),e.text(t.correo,10,62),e.text(t.telefono,10,68),e.setDrawColor(0,170,228),e.line(8,75,200,75),e.setDrawColor(10,10,10),e.line(8,76,200,76)}function setContentBody(e,t){let o=t.detalle_orden;const r=o.map(((e,t)=>(e.precio_unitario=Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(e.precio_unitario),e.descuento=Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(e.descuento),e.importe=Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(e.importe),e)));console.log(r),e.autoTable({theme:"grid",headStyles:{fillColor:[211,211,211],textColor:[54,69,79]},body:r,styles:{cellPadding:1.5,fontSize:9,halign:"center"},columnStyles:{descripcion:{halign:"center"}},columns:[{header:"Codigo",dataKey:"codigo"},{header:"Cantidad",dataKey:"cantidad"},{header:"Descripcion",dataKey:"descripcion"},{header:"Prec. unit",dataKey:"precio_unitario"},{header:"Descuento",dataKey:"descuento"},{header:"Importe",dataKey:"importe"}],startY:80,margin:{left:8},tableWidth:193});let a=8.5*o.length,n=Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(t.subtotal),c=Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(t.descuento),i=Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(t.impuesto),s=Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(t.neto),d=t.tasa.split().pop();e.setTextColor(107,107,107),e.text("Subtotal",135,a+94),e.text("Descuento",135,a+100),e.text("Impuesto "+d+"%",135,a+106),e.text("Total",135,a+114),e.setTextColor(1,1,1),e.text(n,175,a+94),e.text(c,175,a+100),e.text(i,175,a+106),e.text(s,175,a+114);let l=a+150;e.text("Comentarios",8,l-4),e.setDrawColor(213,213,213),e.roundedRect(8,l,193,25,3,3,"S"),e.setTextColor(107,107,107),e.text(t.comentario,10,l+5),setFooter(e,l+46)}function setFooter(e,t){e.text("Firma recibido",95,t),e.line(135,t+15,75,t+15,"F")}