import{initCustomDataTable}from"../DataTable/datatables-init.js";let tabla,estatus_tag;function cancelarUsuario(a){Swal.fire({icon:"question",title:"¿Deseas desactivar esta materia?",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Si",showCloseButton:!0}).then((a=>{a.isConfirmed&&$.ajax({type:"POST",url:BASE_URL+"servidor/historial/eliminar-registro.php",data:{id_reg:id_materia,tabla:"materias"},dataType:"JSON",success:function(a){1==a.estatus?Swal.fire({icon:"success",html:`\n                      ${a.mensaje}<br>\n                      `,allowOutsideClick:!0,confirmButtonText:"Entendido",showCancelButton:!1}).then((a=>{a.isConfirmed&&tabla.ajax.reload(!1)})):Swal.fire({icon:"error",html:`\n                      Ocurrio un error: ${a.mensaje}\n                      `,allowOutsideClick:!0,showCancelButton:!1,confirmButtonText:"Entendido"}).then((a=>{a.isConfirmed&&tabla.ajax.reload(!1)}))}})}))}function editarUsuario(a){$.ajax({type:"post",url:BASE_URL+"servidor/materias/obtener-info-materia.php",data:{id_materia:id_materia},dataType:"json",success:function(a){a.estatus&&Swal.fire({html:`\n                <div class="container">\n                   <div class="row mb-3">\n                      <div class="col-md-6 col-12">\n                          <label>Nombre</label>\n                          <input class="form-control" type="text" id="materia" value="${a.datos.nombre}" placeholder="Materia"/>\n                      </div>\n                      <div class="col-md-6 col-12">\n                          <label>Codigo</label>\n                          <input class="form-control" type="text" id="codigo" value="${a.datos.codigo}" placeholder="Codigo"/>\n                      </div>\n                   </div>\n                   <div class="row mb-3">\n                      <div class="col-md-6 col-12">\n                          <label>Valor creditos</label>\n                          <input class="form-control" type="number" value="${a.datos.valor_creditos}" id="valor_credito" placeholder="0"/>\n                      </div>\n                   </div>\n                </div>\n            `,showCloseButton:!0,confirmButtonText:"Actualizar"}).then((a=>{if(a.isConfirmed){let a=document.getElementById("materia").value,t=document.getElementById("codigo").value,e=document.getElementById("valor_credito").value;$.ajax({type:"post",url:BASE_URL+"servidor/materias/actualizar.php",data:{id_materia:id_materia,nombre:a,codigo:t,valor_credito:e},dataType:"json",success:function(a){a.estatus?Swal.fire({icon:"success",title:a.mensaje}):Swal.fire({icon:"error",title:a.mensaje}),tabla.ajax.reload(null,!1)}})}}))}})}$(document).ready((function(){$("#role").attr("role");const a={1:"Admin",2:"Profesor",3:"Normal",4:"Contraloria"};tabla=initCustomDataTable("#usuarios",BASE_URL+"api/usuarios.php?tipo=datatable",[{data:"id",title:"#"},{data:"id",title:"Foto",render:()=>`<img class="rounded" style="width:40px" src="${BASE_URL}static/img/icons/not-user-img.jpg">`},{data:null,title:"Nombre",render:a=>a.nombre+" "+a.apellido},{data:null,title:"Rol",render:t=>a[t.rol]},{data:"usuario",title:"Usuario"},{data:null,title:"Contraseña",render:a=>a.contraseña.substring(0,10)+"..."},{data:null,title:"Estatus",render:a=>(estatus_tag=1==a.estatus||2==a.estatus?'<span class="badge bg-success">Activo</span>':'<span class="badge bg-secondary">Inactivo</span>',estatus_tag)},{data:null,title:"Opciones",render:function(a,t,e){return`\n              <div class='row'>\n                <div class='col-12 col-md-12'>\n                  <div class="btn btn-primary" onclick="editarSolicitud(${e.id}, false)">\n                    <i class="fa-solid fa-pen-to-square"></i>\n                  </div>\n                  <div class="btn btn-danger" onclick="cancelarUsuario(${e.id})">\n                    <i class="fa-solid fa-trash"></i>\n                  </div>\n                </div>\n              </div>`}}],[[2,"asc"]],[{width:"10%"},null,null,null,null])}));